[
  {
    "objectID": "blog.html",
    "href": "blog.html",
    "title": "Practical Bayesian Extremist",
    "section": "",
    "text": "평활화 기법 소개\n\n\n\n\n\n\nBayesian smoothing\n\n\nTime series\n\n\n\n평활화 기법을 연재하며 \n\n\n\n\n\nOct 3, 2022\n\n\n4 min\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "CV_KOR.html",
    "href": "CV_KOR.html",
    "title": "Curriculum Vitae",
    "section": "",
    "text": "Education\n영국 에든버러 통계학 박사, 2022.  학위논문: “Bayesian analysis of non-stationary extremes”\n영국 에든버러대학교 통계학·OR 석사 2017.  학위논문: “A primer on Benford’s Law”\n연세대학교 경제학 석사, 2003. 학위논문: “장단기 원/달러 환율에 대한 연구: Time-domain과 Frequency-domain 비교”\n한국방송통신대학교 법학사 2010.  연세대학교 경제학사 2001.\n\n\nPublications\nLee, J., de Carvalho, M., Rua, A. & Avila, J. (2024). Bayesian smoothing for time‑varying extremal dependence. Journal of the Royal Statistical Society: Series C, qlae002.\n이준호·김정일·최광신 (2023). 금융권 공동 기후 스트레스테스트, FSS working paper 2023-1.\n윤양인·이준호·황재학,(2023). 기업의 탄소배출과 주가수익률간 관계에 관한 연구. 금융감독연구, 10(2), 1-44..\nLee, J. & de Carvalho, M. (2019). Technological improvements or climate change? Bayesian modeling of time‑varying conformance to Benford’s Law. Plos One, 14(4), e0213300.\n\n\nTalks/Posters\nLee, Junho (2024), “Stress-testing & other macroprudential supervision techniques in the Financial Supervisory Service”, a talk at NFSC-KOICA international conference, ‘Vietnam’s financial market: Opportunities and challenges’, Dec 2023, Dalat, Vietnam.\n이준호·김정일(2023). “금융감독기관의 기후스트레스테스트 진행현황 및 향후계획”. SPGMI-KPMG 웹비나, 2023.3.\nLee, J., & de Carvalho, M. (2021). “Bayesian Semiparametric Inferences for Covariate‑adjusted Extreme‑value Copula with application to Cryptocurrency Markets”. a talk at XXV Congress of the Portuguese Statistical Society, November 2021, Portugal.\nLee, J., de Carvalho, M., & Rua, A. (2021). “Bayesian smoothing of time‑varying extremal dependence in international stock markets”. a talk at Eco‑stats 2021, June 2021, Hong Kong.\nLee, J., de Carvalho, M. & Rua, A. (2019). “Bayesian semiparametric regression for heavy‑tailed responses”. a talk at CMstatistics 2019, 14‑16 December 2019, London, UK.\nLee, J., de Carvalho, M. & Rua, A. (2019). “Bayesian semi‑parametric modelling of heteroscedastic extremes”. a talk at Extreme Value Analysis 2019, July 2019, Zagreb, Croatia.\nLee, J., de Carvalho, M. & Rua, A. (2019). “What hides behind an extreme currency demand? Bayesian semi‑parametric modelling of heteroscedastic extremes”. a poster at Centre for Statistics conference, June 2019, Edinburgh, UK.\nLee, J., & de Carvalho, M. (2018). “Modelling Time‑Varying Conformance to Benford’s Law”. a poster at ISBA 2018 World meeting, June 2018, Edinburgh, UK.\n\n\nWork Experience\n금융감독원 (2003 ~ 현재)\n\n불공정거래 조사 및 시세조종탐지/자금추적 모형 개발 (조사2국), 수석검사역, 2024 – 현재.\n스트레스테스트 및 기후시나리오 분석 (금융시장안정국), 수석조사역, 2021 – 2023.\n불공정거래 조사·기획 (조사1국), 선임검사역, 2013 – 2016.\n금융투자회사 검사(금융투자서비스국·금융투자검사국), 선임검사역, 2010 – 2013.\n파생상품·증권 불공정거래조사 (조사1·2국), 선임검사역, 2007 – 2010.\n지분공시 심사(공시감독국), 조사역, 2005 – 2007.\n검사제도·기획 (검사총괄국), 검사역, 2003 – 2005."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Practical Bayesian Extremist",
    "section": "",
    "text": "블로그에 오신 걸 환영합니다.\n금융감독원에서 베이지안 통계학을 연구하고 응용하는 이준호입니다.\n젊은 시절 경제학과 법학을 공부하였으나, 2010년 중반 데이터 혁명과 기계학습에 감명받아 뒤늦은 40대에 유학길에 올라 영국 에든버러대학교(University of Edinburgh) 평소 관심이 있던 베이즈 통계학(Bayesian statistics)을 공부였습니다.\n극단값 이론과(Extreme value theory) 베이즈비모수통계학(Nonparametric Bayes)을 전공하였고, R 언어를 이용한 실용적인 데이터 분석 패키지 개발과 통계학과 머신러닝 모형의 수학적 배경에 관심을 갖고 있습니다.\n유학 이후 금융감독원에서 거시경제 및 기후경제모형 모델링, 금융산업과 금융회사에 대한 스트레스 테스트 업무를 주로 담당했었고, 현재는 증권 불공정거래 탐색 및 자금추적 모형을 개발하고 있습니다\nHi, I’m Junho Lee, a Bayesian statistician and R programmer.\nI have a PhD in Statistics from the University of Edinburgh and work for the Financial Supervisory Service in South Korea.\nI have worked on various macroeconomic modelling including climate scenario analysis, as well as conducting stress-testing over financial institutions in South Korea.\nMy current interest is on developing fraud detection models in stock market and applying Bayesian networks to account tracking."
  },
  {
    "objectID": "archive.html",
    "href": "archive.html",
    "title": "Archive",
    "section": "",
    "text": "평활화 기법 소개\n\n\n\n\n\n\n\n\nOct 3, 2022\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "CV_ENG.html",
    "href": "CV_ENG.html",
    "title": "Curriculum Vitae",
    "section": "",
    "text": "Education\nDoctor of Philosohpy in Statistics, University of Edinburgh, UK,  “Bayesian analysis of non-stationary extremes”, 2022.\nMaster of Science in Statistics & Oprerational Research, University of Edinburgh,  UK, “A primer on Benford’s Law”, 2017.\nMaster of Arts in Economics, Yonsei University, South Korea,  “A study on the won/dollar exchange rate in the short and long run: comparing the time and frequency domain approaches”, 2003.\nBachelor of Laws, Korea National Open University, South Korea, 2010.  Bachelor of Arts in Economics, Yonsei University, South Korea, 2001.\n\n\nPublications\nLee, J., de Carvalho, M., Rua, A. & Avila, J. (2024). Bayesian smoothing for time‑varying extremal dependence. Journal of the Royal Statistical Society: Series C, qlae002.\nLee, J., Kim, J. & Choi, K. (2023). Joint climate stress-test, FSS working paper 2023-1.\nYoon, Y., Lee, J., & Hwang, J. (2023). A study on the relationship between corporate carbon emissions and stock market returns. Journal of Financial Regulation and Supervision, 10(2), 1–44.\nLee, J. & de Carvalho, M. (2019). Technological improvements or climate change? Bayesian modeling of time‑varying conformance to Benford’s Law. Plos One, 14(4), e0213300.\n\n\nTalks/Posters\nLee, Junho (2024), “Stress-testing & other macroprudential supervision techniques in the Financial Supervisory Service”, a talk at NFSC-KOICA international conference, ‘Vietnam’s financial market: Opportunities and challenges’, Dec 2023, Dalat, Vietnam.\nLee, J., & Kim, J. (2023). “Climate stress‑testing for banking and insurance sectors in South Korea”. a talk at SPGMI_KPMG Webinar, March 2023, on‑line.\nLee, J., & de Carvalho, M. (2021). “Bayesian Semiparametric Inferences for Covariate‑adjusted Extreme‑value Copula with application to Cryptocurrency Markets”. a talk at XXV Congress of the Portuguese Statistical Society, November 2021, Portugal.\nLee, J., de Carvalho, M., & Rua, A. (2021). “Bayesian smoothing of time‑varying extremal dependence in international stock markets”. a talk at Eco‑stats 2021, June 2021, Hong Kong.\nLee, J., de Carvalho, M. & Rua, A. (2019). “Bayesian semiparametric regression for heavy‑tailed responses”. a talk at CMstatistics 2019, 14‑16 December 2019, London, UK.\nLee, J., de Carvalho, M. & Rua, A. (2019). “Bayesian semi‑parametric modelling of heteroscedastic extremes”. a talk at Extreme Value Analysis 2019, July 2019, Zagreb, Croatia.\nLee, J., de Carvalho, M. & Rua, A. (2019). “What hides behind an extreme currency demand? Bayesian semi‑parametric modelling of heteroscedastic extremes”. a poster at Centre for Statistics conference, June 2019, Edinburgh, UK.\nLee, J., & de Carvalho, M. (2018). “Modelling Time‑Varying Conformance to Benford’s Law”. a poster at ISBA 2018 World meeting, June 2018, Edinburgh, UK.\n\n\nWork Experience\nFinancial Supervisory Service (2003 – present)\n\nDeveloping fraud detection models in stock markets, Lead Examiner, 2024 – present.\nStress‑testing of financial companies and scenario analysis of climate‑change, Lead Manager, 2021 – 2023.\nLeave for academic training, 2016 – 2020.\nInvestigating market frauds in capital markets, Senior Examiner, 2013 – 2016.\nExamining financial investment companies, Senior Examiner, 2010 – 2013.\nInvestigating market frauds in stock and derivative markets, Senior Examiner, 2007 – 2010.\nInspecting corporate disclosure reports, Manager, 2005 – 2007.\nDeveloping on‑site examination techniques, Examiner, 2003 – 2005."
  },
  {
    "objectID": "posts/smoothing/smoothing1.html",
    "href": "posts/smoothing/smoothing1.html",
    "title": "평활화 기법 소개",
    "section": "",
    "text": "베이즈 평활화(Bayesian Smoothing)은 비모수 회귀분석(nonparametric regression)의 한 방법으로 여러 방면에서 응용되고 있는 기법이다. 앞으로 지속적인 포스팅을 통하여 베이즈 평활기법의 이론적 부분과 다양한 응용사례를 실제 데이터와 예제 코드를 통하여 소개하고자 한다.\n평활화 기법의 접근방법도 전통적 빈도주의(frequentist) 입장과 베이즈주의(Bayesian) 입장으로 나누어 볼 수 있다. 이번 포스트에서는 전통적인 빈도주의 입장에서 벌점우도(penalized likelihood)의 측면에서 평활화의 개념을 설명하고, 시계열 데이터에 대한 응을 사례를 살펴보고자 한다.\n\n1. 평활화 문제의 설정 (Settings)\n전통적인 평활화 기법은 주로 시계열 관측값(종속변수)가 정규 분포를 따르는 시계열 자료라고 가정하고, 연속하는 추세값의 차이가 크게 벌어지는 경우 이에 대한 벌점을 부여하여 매끄러운 추세선을 만드는 것을 의미한다.\n우리가 \\(T\\) 기간동안 동일한 간격으로 관측한 시계열 자료를 가지고 있다고 생각해 보자. 우리의 관심은 이 시계열 자료의 내제적인 추세를 구하고자 한다. 이 시계열에 대한 관측값을 \\(y_1,\\ldots, y_T\\)라고 하고, 추세를 \\(\\mu_1,\\ldots, \\mu_T\\)라고 하면 다음과 같이 모형을 설정할 수 있다. \\[\ny_t=\\mu_t+\\varepsilon_t,\\quad t=1,\\ldots, T\n\\]\n여기서 \\(\\varepsilon_1,\\ldots,\\varepsilon_T\\) 를 \\(E(\\varepsilon_t)=0,\\;\\forall t\\) 를 만족하는 독립인 오차항을 나타낸다.\n평활화 문제를 실제 데이터에 적용해 보자. 아래 코드는 1990년 이후 월평균 원달러 환율 데이터를 line 그래프로 나타낸 것이다.\n\nR ggplot2R plotly\n\n\n\nlibrary(tidyverse)\nlibrary(zoo)\nlibrary(getMFdata)\n\ndata(usdkrw)\n\nusdkrw &lt;- \n  usdkrw %&gt;% \n  mutate(yearmon=as.yearmon(yearmon))\n\nggplot(data=usdkrw,aes(yearmon,usdkrw))+\n  geom_line()+\n  theme_classic()\n\n\n\n\n\n\n\n\n\n\n\nlibrary(tidyverse)\nlibrary(zoo)\nlibrary(plotly)\nlibrary(getMFdata)\n\ndata(usdkrw)\n\nusdkrw &lt;- \n  usdkrw %&gt;% \n  mutate(yearmon=as.yearmon(yearmon))\n\nplot_ly(data=usdkrw,x=~yearmon,y=~usdkrw) %&gt;% \n  add_lines()\n\n\n\n\n\n\n\n\n\n\n2. 벌점최소제곱기준 (PLS)\nWhittaker는 다음과 같이 벌점최소제곱 (penalised least square; PLS) 기준을 최소하는 방법으로 \\(\\boldsymbol\\mu\\) 를 추정하였다. \\[\n\\text{PLS}(\\boldsymbol \\mu)=\\sum_{t=1}^T (y_t-\\mu_t)^2+\\lambda\\sum_{t=3}^T (\\mu_t-2\\mu_{t-1}+\\mu_{t-2})^2\n\\] PLS를 최소화하기 위해서는 두 가지 요건을 동시에 만족해야 한다. 우선 추세 \\(\\mu_t\\) 가 해당 시점의 관측치 \\(y_t\\)와 가까워야 하고, 둘째 \\(t\\) 시점의 추세가 \\(t-1\\) 시점의 추세에서 크게 벗어나지 않고 매끄러워야 한다. 추세의 매끄러움은 시계열과 추세간 차이에 대한 최소제곱에 다음과 같이 벌점항을 추가하여 고려할 수 있다. \\[\n\\text{pen}(\\boldsymbol\\mu)=\\sum_{t=3}^T(\\mu_t-2\\mu_{t-1}+\\mu_{t-2})^2=\\sum_{t=3}^T(\\triangle^2\\mu_t)^2\n\\] 파라미터 \\(\\lambda\\) 는 두 가지 요건의 상충관계에서 어느쪽에 가중치를 둘 것인지를 결정한다. 여기서 오차항 \\(\\varepsilon_t\\) 가 독립이고, 모든 \\(t\\) 에 대하여 동일한 분산, \\(Var(\\varepsilon_t)=\\sigma^2\\) 이라고 가정한다. 일반적으로 \\(\\mu_t\\) 의 편차에 대한 \\(d\\) 차 벌점은 다음과 같이 정의한다. \\[\n\\text{pen}(\\boldsymbol\\mu) = \\sum_{t=d+1}^T (\\triangle^d\\mu_t)^2,\\quad \\triangle^d \\mu_t=\\triangle^{d-1}\\mu_t-\\triangle^{d-1}\\mu_{t-1}\n\\] \\(d=1\\) 인 경우 수평선 \\(\\mu_t=a\\) 로부터 편차에 대하여 벌점을 부과하고, \\(d=2\\) 인 경우 직선 \\(\\mu_t=a+bt\\) 로부터의 편차에 벌점을 부과한다. 일반적으로 \\(d\\) 차 벌점은 차수 \\(d-1\\) 차 다항식으로부터 편차에 대하여 벌점을 부과한다.\n\n\n3. 행렬표현 (Matrix notation)\n이제 벌점항을 행렬로 간단히 표기하는 법을 알아보자. \\(\\mu_1,\\ldots,\\mu_T\\) 에 대한 1차 차분 행렬은 다음과 같이 주어진다. \\[\n\\mathbf D_1^{(T-1)\\times T}=\\begin{pmatrix}-1& 1 &0& \\cdots& 0\\\\ \\vdots&-1&1&&\\vdots\\\\0&\\cdots&&-1&1\\\\\\end{pmatrix},\\qquad \\mathbf D_1^{(T-1)\\times T}\\boldsymbol\\gamma=\\begin{pmatrix}\\mu_2-\\mu_1 \\\\ \\cdots\\\\ \\mu_T-\\mu_{T-1}\\\\\\end{pmatrix}\n\\] 일반적인 고차 차분행렬은 다음 식을 이용하여 순차적으로 구할 수 있다. \\[\n\\mathbf D_d^{(T-d)\\times T}=\\mathbf D_1^{(T-d)\\times (T-d+1)}\\mathbf D_{d-1}^{(T-d+1)\\times T}\n\\] 예를 들어 2차 차분행렬은 \\(\\mathbf D_1^{(T-2)\\times (T-1)}\\times \\mathbf D_1^{(T-1)\\times T}\\) 로부터 \\[\n\\mathbf D_2^{(T-2)\\times T}=\\begin{pmatrix}1& -2 &1& &\\cdots& 0\\\\ &1&-2&1&\\\\\\vdots&&\\ddots&\\ddots&\\ddots&\\vdots\\\\0 &&&1&-2&1\\\\\\end{pmatrix}\n\\] 이다. 이제 차분행렬 \\(D\\)로 부터 벌점행렬 \\(K\\) 를 구해보자. 벌점항을 다시 정리하면 \\[\n\\text{pen}(\\boldsymbol\\mu)=\\sum_{t=d+1}^T (\\triangle^d\\mu_t)^2=\\boldsymbol\\mu \\mathbf D_d'\\mathbf D_d\\boldsymbol\\mu=\\boldsymbol\\mu \\mathbf K_d \\boldsymbol\\mu\n\\] 여기서 \\(\\mathbf K_d=\\mathbf D_d'\\mathbf D_d\\) 로 \\(T\\times T\\) 차원의 벌점행렬을 만든다. 1차 벌점행렬과 2차 벌점행렬을 구하면 다음과 같다. \\[\n\\small\n\\mathbf K_1 = \\begin{pmatrix}1&-1&&&\\cdots&0\\\\-1&2&-1&&\\cdots&0\\\\0&-1&2&-1&\\cdots&0\\\\\\vdots&&&\\ddots&\\ddots&\\vdots\\\\0&0&\\cdots&-1&2&-1\\\\ 0&0&\\cdots&0&-1&1\\end{pmatrix},\\qquad \\mathbf K_2=\\begin{pmatrix}1&-2&1&&&\\cdots&0\\\\-2&5&-4&1&&\\cdots&0\\\\1&-4&6&-4&1&\\cdots&0\\\\\\vdots&&&\\ddots&\\ddots&&\\vdots\\\\0&0&\\cdots&1&-4&5&-2\\\\ 0&0&\\cdots&&1&-2&1\\end{pmatrix}\n\\]\n여기서 벌점행렬의 랭크는 \\(\\text{rank}(\\mathbf K_d)=T-d\\) 로 완전한 랭크를 갖지 않는다. 따라서, 벌점을 적용받지 않는 \\(d-1\\)차까지의 다항식은 \\(\\mathbf K_d\\) 의 널공간(null space)을 형성한다. 이제 모형을 행렬과 벡터를 이용하여 다시 정의하자. \\[\n\\text{PLS}(\\boldsymbol\\mu)=(\\mathbf y-\\boldsymbol\\mu)'(\\mathbf y-\\boldsymbol\\mu)+\\lambda\\boldsymbol\\mu'\\mathbf K\\boldsymbol\\mu = \\mathbf y '\\mathbf y -2\\boldsymbol\\mu'\\mathbf y+\\boldsymbol\\mu'(\\mathbf I +\\lambda\\mathbf K)\\boldsymbol\\mu\n\\]\n\n\n4. 추론 (Inference)\n이제는 최소제곱기준을 극대화시키는 \\(\\boldsymbol\\mu\\)를 구해보자.\n극대값을 구하기 위하여 PLS 기준을 미분하면 \\[\n\\frac{\\partial \\text{PLS}(\\boldsymbol\\mu)}{\\partial\\boldsymbol\\mu}=-2\\mathbf y + 2(\\mathbf I +\\lambda \\mathbf K )\\boldsymbol\\mu=0\\quad \\Rightarrow\\quad \\hat{\\boldsymbol\\mu}=(I+\\lambda \\mathbf K)^{-1}\\mathbf y\n\\] PLS 추정량(estimator)은 능형회귀 (ridge shrinkage) 추정량과 동일하게 관측치 \\(y\\) 를 부드러운 추세 \\(\\mu\\)의 값으로 끌어 당기는 현상이 나타난다. PLS 추정량의 기대값과 분산은 다음과 같다.\n\n\nPLS 추정량은 편의 추정량(biased)이다. 즉, \\[E(\\hat{\\boldsymbol\\mu})=E[(\\mathbf I +\\lambda \\mathbf K)^{-1}\\mathbf y)=(\\mathbf I+\\lambda\\mathbf K)^{-1}\\boldsymbol\\mu.\\]\n오차항을 i.i.d.라 가정하면 분산은 \\[Cov(\\hat{\\mathbf\\mu})=(\\mathbf I+\\lambda\\mathbf K)^{-1}Cov(\\mathbf y)(\\mathbf I+\\lambda\\mathbf K)^{-1}=\\sigma^2(\\mathbf I+\\lambda\\mathbf K)^{-1}\\]\n\n\nPLS 추정치는 분산을 줄임으로써 평균제곱오차(mean squared error; MSE)를 감소시킨다. \\(\\lambda\\)의 값이 작으면 편차가 작아지지만 변동성이 크고, \\(\\lambda\\)의 값이 크면 변동성은 적지만 편차가 커진다. 마지막으로 오차가 iid인 가우스 분포를 따른다고 하면, 즉 \\(\\varepsilon_t\\sim N(0,\\sigma^2)\\) 이면 PLS 추정량의 분포는 다음과 같다. \\[\n\\hat{\\boldsymbol\\mu}\\sim N((\\mathbf I+\\lambda\\mathbf K)^{-1}\\mathbf y,\\sigma^2(I+\\lambda\\mathbf K)^{-2})\n\\]"
  }
]